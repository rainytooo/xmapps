class CreateDlTypes < ActiveRecord::Migration
  def self.up
    create_table :dl_types do |t|
	  t.references :dl_type
      t.string :typename, :limit  => 64
      t.integer :type_lv, :limit  => 2, :default => 0

      t.timestamps
    end
	execute <<-SQL
      ALTER TABLE dl_types
        ADD CONSTRAINT fk_dltypes_parentdltypes
        FOREIGN KEY (dl_type_id)
        REFERENCES dl_types(id)
    SQL
	
	execute <<-SQL
      INSERT INTO `dl_types` (`id`, `dl_type_id`, `typename`, `type_lv`, `created_at`, `updated_at`) VALUES
		(1, NULL, 'root', 0, '2011-05-16 02:16:38', '2011-05-16 02:16:38'),
		(2, 1, '英语学习资料', 1, '2011-05-16 02:16:55', '2011-05-16 02:16:55'),
		(3, 2, '托福', 2, '2011-05-16 02:17:07', '2011-05-16 02:17:07'),
		(4, 2, '雅思', 2, '2011-05-16 02:17:14', '2011-05-16 02:17:14'),
		(5, 2, 'SAT', 2, '2011-05-16 02:17:23', '2011-05-16 02:17:23'),
		(6, 3, '托福听力', 3, '2011-05-16 02:17:44', '2011-05-16 02:17:44'),
		(7, 3, '托福阅读', 3, '2011-05-16 02:17:54', '2011-05-16 02:17:54'),
		(8, 2, '工具软件', 2, '2011-05-16 02:18:19', '2011-05-16 02:18:19'),
		(9, 2, '有声读物', 2, '2011-05-16 02:20:59', '2011-05-16 02:20:59'),
		(10, 3, '托福口语', 3, '2011-05-16 02:22:49', '2011-05-16 02:22:49'),
		(11, 3, '托福写作', 3, '2011-05-16 02:23:06', '2011-05-16 02:23:06'),
		(12, 3, '托福综合', 3, '2011-05-16 02:24:03', '2011-05-16 02:24:03'),
		(13, 2, '小马过河备考听力包', 2, '2011-05-16 02:24:03', '2011-05-16 02:24:03'),
		(14,5,'SAT词汇',3,'2011-05-27 11:38:56','2011-05-27 11:38:56'),
		(15,5,'SAT阅读',3,'2011-05-27 11:39:14','2011-05-27 11:39:14'),
		(16,5,'SAT写作',3,'2011-05-27 11:39:27','2011-05-27 11:39:27'),
		(17,5,'SAT数学',3,'2011-05-27 11:39:36','2011-05-27 11:39:36'),
		(18,5,'SAT2',3,'2011-05-27 11:39:49','2011-05-27 11:39:49'),
		(19,2,'GRE',2,'2011-05-27 11:40:46','2011-05-27 11:40:46'),
		(20,19,'GRE词汇',3,'2011-05-27 11:41:09','2011-05-27 11:41:09'),
		(21,19,'GRE填空',3,'2011-05-27 11:41:21','2011-05-27 11:41:21'),
		(22,19,'GRE阅读',3,'2011-05-27 11:41:35','2011-05-27 11:41:35'),
		(23,19,'GRE写作',3,'2011-05-27 11:41:46','2011-05-27 11:41:46'),
		(24,19,'GRE数学',3,'2011-05-27 11:41:57','2011-05-27 11:41:57'),
		(25,19,'GRE综合',3,'2011-05-27 11:42:20','2011-05-27 11:42:20'),
		(26,19,'GRE SUB',3,'2011-05-27 11:42:32','2011-05-27 11:42:32'),
		(27,2,'GMAT',2,'2011-05-27 11:43:08','2011-05-27 11:43:08'),
		(28,27,'GMAT词汇',3,'2011-05-27 11:43:19','2011-05-27 11:43:19'),
		(29,27,'GMAT写作',3,'2011-05-27 11:43:30','2011-05-27 11:43:30'),
		(30,27,'GMAT数学',3,'2011-05-27 11:43:47','2011-05-27 11:43:47'),
		(31,27,'GMAT阅读',3,'2011-05-27 11:43:56','2011-05-27 11:43:56'),
		(32,27,'GMAT逻辑',3,'2011-05-27 11:44:06','2011-05-27 11:44:06'),
		(33,27,'GMAT语法',3,'2011-05-27 11:44:31','2011-05-27 11:44:31'),
		(34,27,'GMAT综合',3,'2011-05-27 11:44:42','2011-05-27 11:44:42'),
		(35,4,'雅思词汇',3,'2011-05-27 11:45:09','2011-05-27 11:45:09'),
		(36,4,'雅思听力',3,'2011-05-27 11:45:18','2011-05-27 11:45:18'),
		(37,4,'雅思阅读',3,'2011-05-27 11:45:42','2011-05-27 11:45:42'),
		(38,4,'雅思口语',3,'2011-05-27 11:45:51','2011-05-27 11:45:51'),
		(39,4,'雅思写作',3,'2011-05-27 11:46:00','2011-05-27 11:46:00'),
		(40,4,'雅思综合',3,'2011-05-27 11:46:08','2011-05-27 11:46:08'),
		(41,5,'SAT1综合',3,'2011-05-27 11:51:28','2011-05-27 11:51:28')
    SQL
  end

  def self.down
	execute "ALTER TABLE dl_types DROP FOREIGN KEY fk_dltypes_parentdltypes"
    drop_table :dl_types
  end
end
